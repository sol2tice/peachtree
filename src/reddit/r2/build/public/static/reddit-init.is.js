try{(function(a,b){typeof define==="function"&&define.amd?define(b):typeof exports==="object"?module.exports=b():a.returnExports=b()})(this,function(){function a(){}function b(a){a=+a;a!==a?a=0:a!==0&&a!==1/0&&a!==-(1/0)&&(a=(a>0||-1)*Math.floor(Math.abs(a)));return a}function e(a){var b=typeof a;return a===null||b==="undefined"||b==="boolean"||b==="number"||b==="string"}var c=Function.prototype.call,i=Object.prototype,j=Array.prototype.slice,g=Array.prototype.splice,m=Array.prototype.unshift,k=i.toString,
o=function(a){return i.toString.call(a)==="[object Function]"},v=function(a){return k.call(a)==="[object Array]"},u=function(a){var b=k.call(a),e=b==="[object Arguments]";e||(e=!v(b)&&a!==null&&typeof a==="object"&&typeof a.length==="number"&&a.length>=0&&o(a.callee));return e};if(!Function.prototype.bind)Function.prototype.bind=function(b){var e=this;if(!o(e))throw new TypeError("Function.prototype.bind called on incompatible "+e);for(var g=j.call(arguments,1),c=Math.max(0,e.length-g.length),h=[],
i=0;i<c;i++)h.push("$"+i);var l=Function("binder","return function ("+h.join(",")+"){return binder.apply(this,arguments)}")(function(){if(this instanceof l){var a=e.apply(this,g.concat(j.call(arguments)));if(Object(a)===a)return a;return this}else return e.apply(b,g.concat(j.call(arguments)))});if(e.prototype)a.prototype=e.prototype,l.prototype=new a,a.prototype=null;return l};var p=c.bind(i.hasOwnProperty);p(i,"__defineGetter__")&&(c.bind(i.__defineGetter__),c.bind(i.__defineSetter__),c.bind(i.__lookupGetter__),
c.bind(i.__lookupSetter__));var c=function(){var a={};Array.prototype.splice.call(a,0,0,1);return a.length===1}(),n=[1].splice(0).length===0;if(function(){var a=[1,2],b=a.splice();return a.length===2&&v(b)&&b.length===0}())Array.prototype.splice=function(){return arguments.length===0?[]:g.apply(this,arguments)};if(!n||!c)Array.prototype.splice=function(a,e){if(arguments.length===0)return[];var c=arguments;this.length=Math.max(b(this.length),0);arguments.length>0&&typeof e!=="number"&&(c=j.call(arguments),
c.length<2?c.push(b(e)):c[1]=b(e));return g.apply(this,c)};if([].unshift(0)!==1)Array.prototype.unshift=function(){m.apply(this,arguments);return this.length};if(!Array.isArray)Array.isArray=v;var c=Object("a"),s=c[0]!=="a"||!(0 in c),c=function(a){var b=!0,e=!0;a&&(a.call("foo",function(a,e,g){typeof g!=="object"&&(b=!1)}),a.call([1],function(){e=typeof this==="string"},"x"));return!!a&&b&&e};if(!Array.prototype.forEach||!c(Array.prototype.forEach))Array.prototype.forEach=function(a,b){var e=x(this),
g=s&&k.call(this)==="[object String]"?this.split(""):e,c=-1,h=g.length>>>0;if(!o(a))throw new TypeError;for(;++c<h;)c in g&&a.call(b,g[c],c,e)};if(!Array.prototype.map||!c(Array.prototype.map))Array.prototype.map=function(a,b){var e=x(this),g=s&&k.call(this)==="[object String]"?this.split(""):e,c=g.length>>>0,h=Array(c);if(!o(a))throw new TypeError(a+" is not a function");for(var l=0;l<c;l++)l in g&&(h[l]=a.call(b,g[l],l,e));return h};if(!Array.prototype.filter||!c(Array.prototype.filter))Array.prototype.filter=
function(a,b){var e=x(this),g=s&&k.call(this)==="[object String]"?this.split(""):e,c=g.length>>>0,h=[],l;if(!o(a))throw new TypeError(a+" is not a function");for(var z=0;z<c;z++)z in g&&(l=g[z],a.call(b,l,z,e)&&h.push(l));return h};if(!Array.prototype.every||!c(Array.prototype.every))Array.prototype.every=function(a,b){var e=x(this),g=s&&k.call(this)==="[object String]"?this.split(""):e,c=g.length>>>0;if(!o(a))throw new TypeError(a+" is not a function");for(var h=0;h<c;h++)if(h in g&&!a.call(b,g[h],
h,e))return!1;return!0};if(!Array.prototype.some||!c(Array.prototype.some))Array.prototype.some=function(a,b){var e=x(this),g=s&&k.call(this)==="[object String]"?this.split(""):e,c=g.length>>>0;if(!o(a))throw new TypeError(a+" is not a function");for(var h=0;h<c;h++)if(h in g&&a.call(b,g[h],h,e))return!0;return!1};c=!1;Array.prototype.reduce&&(c=typeof Array.prototype.reduce.call("es5",function(a,b,e,g){return g})==="object");if(!Array.prototype.reduce||!c)Array.prototype.reduce=function(a){var b=
x(this),e=s&&k.call(this)==="[object String]"?this.split(""):b,g=e.length>>>0;if(!o(a))throw new TypeError(a+" is not a function");if(!g&&arguments.length===1)throw new TypeError("reduce of empty array with no initial value");var c=0,h;if(arguments.length>=2)h=arguments[1];else{do{if(c in e){h=e[c++];break}if(++c>=g)throw new TypeError("reduce of empty array with no initial value");}while(1)}for(;c<g;c++)c in e&&(h=a.call(void 0,h,e[c],c,b));return h};c=!1;Array.prototype.reduceRight&&(c=typeof Array.prototype.reduceRight.call("es5",
function(a,b,e,g){return g})==="object");if(!Array.prototype.reduceRight||!c)Array.prototype.reduceRight=function(a){var b=x(this),e=s&&k.call(this)==="[object String]"?this.split(""):b,g=e.length>>>0;if(!o(a))throw new TypeError(a+" is not a function");if(!g&&arguments.length===1)throw new TypeError("reduceRight of empty array with no initial value");var c;g-=1;if(arguments.length>=2)c=arguments[1];else{do{if(g in e){c=e[g--];break}if(--g<0)throw new TypeError("reduceRight of empty array with no initial value");
}while(1)}if(g<0)return c;do g in e&&(c=a.call(void 0,c,e[g],g,b));while(g--);return c};if(!Array.prototype.indexOf||[0,1].indexOf(1,2)!==-1)Array.prototype.indexOf=function(a){var e=s&&k.call(this)==="[object String]"?this.split(""):x(this),g=e.length>>>0;if(!g)return-1;var c=0;arguments.length>1&&(c=b(arguments[1]));for(c=c>=0?c:Math.max(0,g+c);c<g;c++)if(c in e&&e[c]===a)return c;return-1};if(!Array.prototype.lastIndexOf||[0,1].lastIndexOf(0,-3)!==-1)Array.prototype.lastIndexOf=function(a){var e=
s&&k.call(this)==="[object String]"?this.split(""):x(this),g=e.length>>>0;if(!g)return-1;var c=g-1;arguments.length>1&&(c=Math.min(c,b(arguments[1])));for(c=c>=0?c:g-Math.abs(c);c>=0;c--)if(c in e&&a===e[c])return c;return-1};c=Object.keys&&function(){return Object.keys(arguments).length===2}(1,2);if(Object.keys){if(!c){var A=Object.keys;Object.keys=function(a){return u(a)?A(Array.prototype.slice.call(a)):A(a)}}}else{var w=!{toString:null}.propertyIsEnumerable("toString"),q=function(){}.propertyIsEnumerable("prototype"),
C=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],J=C.length;Object.keys=function(a){var b=o(a),e=u(a),g=a!==null&&typeof a==="object",c=g&&k.call(a)==="[object String]";if(!g&&!b&&!e)throw new TypeError("Object.keys called on a non-object");g=[];b=q&&b;if(c||e)for(e=0;e<a.length;++e)g.push(String(e));else for(var h in a)!(b&&h==="prototype")&&p(a,h)&&g.push(String(h));if(w){e=(e=a.constructor)&&e.prototype===a;for(c=0;c<J;c++)h=C[c],!(e&&
h==="constructor")&&p(a,h)&&g.push(h)}return g}}if(!Date.prototype.toISOString||(new Date(-621987552E5)).toISOString().indexOf("-000001")===-1)Date.prototype.toISOString=function(){var a,b,e,g;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");g=this.getUTCFullYear();a=this.getUTCMonth();g+=Math.floor(a/12);a=[(a%12+12)%12+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()];g=(g<0?"-":g>9999?"+":"")+("00000"+Math.abs(g)).slice(0<=
g&&g<=9999?-4:-6);for(b=a.length;b--;)e=a[b],e<10&&(a[b]="0"+e);return g+"-"+a.slice(0,2).join("-")+"T"+a.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"};c=!1;try{c=Date.prototype.toJSON&&(new Date(NaN)).toJSON()===null&&(new Date(-621987552E5)).toJSON().indexOf("-000001")!==-1&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(F){}if(!c)Date.prototype.toJSON=function(){var a=Object(this),b;a:if(e(a))b=a;else{b=a.valueOf;if(o(b)&&(b=b.call(a),e(b)))break a;
b=a.toString;if(o(b)&&(b=b.call(a),e(b)))break a;throw new TypeError;}if(typeof b==="number"&&!isFinite(b))return null;b=a.toISOString;if(typeof b!=="function")throw new TypeError("toISOString property is not callable");return b.call(a)};var c=Date.parse("+033658-09-27T01:46:40.000Z")===1E15,n=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z")),h=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(!Date.parse||h||n||!c)Date=function(a){function b(l,e,g,c,h,
i,m){var k=arguments.length;if(this instanceof a)return k=k===1&&String(l)===l?new a(b.parse(l)):k>=7?new a(l,e,g,c,h,i,m):k>=6?new a(l,e,g,c,h,i):k>=5?new a(l,e,g,c,h):k>=4?new a(l,e,g,c):k>=3?new a(l,e,g):k>=2?new a(l,e):k>=1?new a(l):new a,k.constructor=b,k;return a.apply(this,arguments)}function e(a,b){var g=b>1?1:0;return c[b]+Math.floor((a-1969+g)/4)-Math.floor((a-1901+g)/100)+Math.floor((a-1601+g)/400)+365*(a-1970)}var g=RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),
c=[0,31,59,90,120,151,181,212,243,273,304,334,365],h;for(h in a)b[h]=a[h];b.now=a.now;b.UTC=a.UTC;b.prototype=a.prototype;b.prototype.constructor=b;b.parse=function(l){var b=g.exec(l);if(b){var c=Number(b[1]),h=Number(b[2]||1)-1,i=Number(b[3]||1)-1,m=Number(b[4]||0),k=Number(b[5]||0),p=Number(b[6]||0),j=Math.floor(Number(b[7]||0)*1E3),o=Boolean(b[4]&&!b[8]),n=b[9]==="-"?1:-1,u=Number(b[10]||0),b=Number(b[11]||0);if(m<(k>0||p>0||j>0?24:25)&&k<60&&p<60&&j<1E3&&h>-1&&h<12&&u<24&&b<60&&i>-1&&i<e(c,h+
1)-e(c,h))if(c=((e(c,h)+i)*24+m+u*n)*60,c=((c+k+b*n)*60+p)*1E3+j,o&&(c=Number(new a(1970,0,1,0,0,0,c))),-864E13<=c&&c<=864E13)return c;return NaN}return a.parse.apply(this,arguments)};return b}(Date);if(!Date.now)Date.now=function(){return(new Date).getTime()};(!Number.prototype.toFixed||(8.0E-5).toFixed(3)!=="0.000"||(0.9).toFixed(0)==="0"||(1.255).toFixed(2)!=="1.25"||(1000000000000000128).toFixed(0)!=="1000000000000000128")&&function(){function a(b,e){for(var g=-1;++g<h;)e+=b*l[g],l[g]=e%c,e=Math.floor(e/
c)}function b(a){for(var e=h,g=0;--e>=0;)g+=l[e],l[e]=Math.floor(g/a),g=g%a*c}function e(){for(var a=h,b="";--a>=0;)if(b!==""||a===0||l[a]!==0){var g=String(l[a]);b===""?b=g:b+="0000000".slice(0,7-g.length)+g}return b}function g(a,b,l){return b===0?l:b%2===1?g(a,b-1,l*a):g(a*a,b/2,l)}var c,h,l;c=1E7;h=6;l=[0,0,0,0,0,0];Number.prototype.toFixed=function(l){var c,h,i,l=Number(l),l=l!==l?0:Math.floor(l);if(l<0||l>20)throw new RangeError("Number.toFixed called with invalid number of decimals");c=Number(this);
if(c!==c)return"NaN";if(c<=-1.0E21||c>=1.0E21)return String(c);h="";c<0&&(h="-",c=-c);i="0";if(c>1.0E-21){i=c*g(2,69,1);for(var k=0;i>=4096;)k+=12,i/=4096;for(;i>=2;)k+=1,i/=2;i=k-69;c=i<0?c*g(2,-i,1):c/g(2,i,1);c*=4503599627370496;i=52-i;if(i>0){a(0,c);for(c=l;c>=7;)a(1E7,0),c-=7;a(g(10,c,1),0);for(c=i-1;c>=23;)b(8388608),c-=23;b(1<<c);a(1,1);b(2);i=e()}else a(0,c),a(1<<-i,0),i=e()+"0.00000000000000000000".slice(2,2+l)}l>0?(c=i.length,i=c<=l?h+"0.0000000000000000000".slice(0,l-c+2)+i:h+i.slice(0,
c-l)+"."+i.slice(c-l)):i=h+i;return i}}();var t=String.prototype.split;if("ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1)(function(){var a=/()??/.exec("")[1]===void 0;String.prototype.split=function(b,c){var e=this;if(b===void 0&&c===0)return[];if(k.call(b)!=="[object RegExp]")return t.call(this,b,c);var g=[],h=(b.ignoreCase?"i":"")+(b.multiline?"m":"")+(b.extended?
"x":"")+(b.sticky?"y":""),l=0,z,y,i,b=RegExp(b.source,h+"g");e+="";a||(z=RegExp("^"+b.source+"$(?!\\s)",h));for(c=c===void 0?4294967295:c>>>0;y=b.exec(e);){h=y.index+y[0].length;if(h>l&&(g.push(e.slice(l,y.index)),!a&&y.length>1&&y[0].replace(z,function(){for(var a=1;a<arguments.length-2;a++)arguments[a]===void 0&&(y[a]=void 0)}),y.length>1&&y.index<e.length&&Array.prototype.push.apply(g,y.slice(1)),i=y[0].length,l=h,g.length>=c))break;b.lastIndex===y.index&&b.lastIndex++}l===e.length?(i||!b.test(""))&&
g.push(""):g.push(e.slice(l));return g.length>c?g.slice(0,c):g}})();else if("0".split(void 0,0).length)String.prototype.split=function(a,b){if(a===void 0&&b===0)return[];return t.call(this,a,b)};var D=String.prototype.replace;if(!function(){var a=[];"x".replace(/x(.)?/g,function(b,c){a.push(c)});return a.length===1&&typeof a[0]==="undefined"}())String.prototype.replace=function(a,b){var c=o(b),g=i.toString.call(a)==="[object RegExp]"&&/\)[*?]/.test(a.source);return!c||!g?D.call(this,a,b):D.call(this,
a,function(c){var g=arguments.length,l=a.lastIndex;a.lastIndex=0;var e=a.exec(c);a.lastIndex=l;e.push(arguments[g-2],arguments[g-1]);return b.apply(this,e)})};if("".substr&&"0b".substr(-1)!=="b"){var E=String.prototype.substr;String.prototype.substr=function(a,b){return E.call(this,a<0?(a=this.length+a)<0?0:a:a,b)}}c="\t\n\u000b\u000c\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff";if(!String.prototype.trim||c.trim()||!"\u200b".trim()){var c=
"["+c+"]",G=RegExp("^"+c+c+"*"),H=RegExp(c+c+"*$");String.prototype.trim=function(){if(this===void 0||this===null)throw new TypeError("can't convert "+this+" to object");return String(this).replace(G,"").replace(H,"")}}if(parseInt(c+"08")!==8||parseInt(c+"0x16")!==22)parseInt=function(a){var b=/^0[xX]/;return function(c,g){c=String(c).trim();Number(g)||(g=b.test(c)?16:10);return a(c,g)}}(parseInt);var x=function(a){if(a==null)throw new TypeError("can't convert "+a+" to object");return Object(a)}});
var JSON;JSON||(JSON={});(function(){function a(a){return a<10?"0"+a:a}function b(a){i.lastIndex=0;return i.test(a)?'"'+a.replace(i,function(a){var b=m[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function e(a,c){var i,m,n,s,A=j,w,q=c[a];q&&typeof q==="object"&&typeof q.toJSON==="function"&&(q=q.toJSON(a));typeof k==="function"&&(q=k.call(c,a,q));switch(typeof q){case "string":return b(q);case "number":return isFinite(q)?String(q):"null";case "boolean":case "null":return String(q);
case "object":if(!q)return"null";j+=g;w=[];if(Object.prototype.toString.apply(q)==="[object Array]"){s=q.length;for(i=0;i<s;i+=1)w[i]=e(i,q)||"null";n=w.length===0?"[]":j?"[\n"+j+w.join(",\n"+j)+"\n"+A+"]":"["+w.join(",")+"]";j=A;return n}if(k&&typeof k==="object"){s=k.length;for(i=0;i<s;i+=1)typeof k[i]==="string"&&(m=k[i],(n=e(m,q))&&w.push(b(m)+(j?": ":":")+n))}else for(m in q)Object.prototype.hasOwnProperty.call(q,m)&&(n=e(m,q))&&w.push(b(m)+(j?": ":":")+n);n=w.length===0?"{}":j?"{\n"+j+w.join(",\n"+
j)+"\n"+A+"}":"{"+w.join(",")+"}";j=A;return n}}if(typeof Date.prototype.toJSON!=="function")Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
i=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,j,g,m={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;if(typeof JSON.stringify!=="function")JSON.stringify=function(a,b,c){var i;g=j="";if(typeof c==="number")for(i=0;i<c;i+=1)g+=" ";else typeof c==="string"&&(g=c);if((k=b)&&typeof b!=="function"&&(typeof b!=="object"||typeof b.length!=="number"))throw Error("JSON.stringify");return e("",
{"":a})};if(typeof JSON.parse!=="function")JSON.parse=function(a,b){function g(a,c){var e,i,m=a[c];if(m&&typeof m==="object")for(e in m)Object.prototype.hasOwnProperty.call(m,e)&&(i=g(m,e),i!==void 0?m[e]=i:delete m[e]);return b.call(a,c,m)}var e,a=String(a);c.lastIndex=0;c.test(a)&&(a=a.replace(c,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),typeof b==="function"?g({"":e},""):e;throw new SyntaxError("JSON.parse");}})();(function(){var a=this,b=a._,e={},c=Array.prototype,i=Object.prototype,j=c.push,g=c.slice,m=c.concat,k=i.toString,o=i.hasOwnProperty,v=c.forEach,u=c.map,p=c.reduce,n=c.reduceRight,s=c.filter,A=c.every,w=c.some,q=c.indexOf,C=c.lastIndexOf,i=Array.isArray,J=Object.keys,F=Function.prototype.bind,h=function(a){if(a instanceof h)return a;if(!(this instanceof h))return new h(a);
this._wrapped=a};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=h;exports._=h}else a._=h;h.VERSION="1.4.4";var t=h.each=h.forEach=function(a,b,c){if(a!=null)if(v&&a.forEach===v)a.forEach(b,c);else if(a.length===+a.length)for(var g=0,i=a.length;g<i;g++){if(b.call(c,a[g],g,a)===e)break}else for(g in a)if(h.has(a,g)&&b.call(c,a[g],g,a)===e)break};h.map=h.collect=function(a,b,c){var g=[];if(a==null)return g;if(u&&a.map===u)return a.map(b,c);t(a,
function(a,l,e){g[g.length]=b.call(c,a,l,e)});return g};h.reduce=h.foldl=h.inject=function(a,b,c,g){var e=arguments.length>2;a==null&&(a=[]);if(p&&a.reduce===p)return g&&(b=h.bind(b,g)),e?a.reduce(b,c):a.reduce(b);t(a,function(a,l,h){e?c=b.call(g,c,a,l,h):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c};h.reduceRight=h.foldr=function(a,b,c,g){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduceRight===n)return g&&(b=h.bind(b,g)),e?a.reduceRight(b,
c):a.reduceRight(b);var i=a.length;if(i!==+i)var m=h.keys(a),i=m.length;t(a,function(h,k,j){k=m?m[--i]:--i;e?c=b.call(g,c,a[k],k,j):(c=a[k],e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c};h.find=h.detect=function(a,b,c){var g;D(a,function(a,l,e){if(b.call(c,a,l,e))return g=a,!0});return g};h.filter=h.select=function(a,b,c){var g=[];if(a==null)return g;if(s&&a.filter===s)return a.filter(b,c);t(a,function(a,l,e){b.call(c,a,l,e)&&(g[g.length]=a)});return g};
h.reject=function(a,b,c){return h.filter(a,function(a,g,l){return!b.call(c,a,g,l)},c)};h.every=h.all=function(a,b,c){b||(b=h.identity);var g=!0;if(a==null)return g;if(A&&a.every===A)return a.every(b,c);t(a,function(a,l,h){if(!(g=g&&b.call(c,a,l,h)))return e});return!!g};var D=h.some=h.any=function(a,b,c){b||(b=h.identity);var g=!1;if(a==null)return g;if(w&&a.some===w)return a.some(b,c);t(a,function(a,l,h){if(g||(g=b.call(c,a,l,h)))return e});return!!g};h.contains=h.include=function(a,b){if(a==null)return!1;
if(q&&a.indexOf===q)return a.indexOf(b)!=-1;return D(a,function(a){return a===b})};h.invoke=function(a,b){var c=g.call(arguments,2),e=h.isFunction(b);return h.map(a,function(a){return(e?b:a[b]).apply(a,c)})};h.pluck=function(a,b){return h.map(a,function(a){return a[b]})};h.where=function(a,b,c){if(h.isEmpty(b))return c?null:[];return h[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})};h.findWhere=function(a,b){return h.where(a,b,!0)};h.max=function(a,b,c){if(!b&&
h.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&h.isEmpty(a))return-Infinity;var g={computed:-Infinity,value:-Infinity};t(a,function(a,e,l){e=b?b.call(c,a,e,l):a;e>=g.computed&&(g={value:a,computed:e})});return g.value};h.min=function(a,b,c){if(!b&&h.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&h.isEmpty(a))return Infinity;var g={computed:Infinity,value:Infinity};t(a,function(a,e,l){e=b?b.call(c,a,e,l):a;e<g.computed&&(g={value:a,computed:e})});
return g.value};h.shuffle=function(a){var b,c=0,g=[];t(a,function(a){b=h.random(c++);g[c-1]=g[b];g[b]=a});return g};var E=function(a){return h.isFunction(a)?a:function(b){return b[a]}};h.sortBy=function(a,b,c){var g=E(b);return h.pluck(h.map(a,function(a,b,e){return{value:a,index:b,criteria:g.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,g=b.criteria;if(c!==g){if(c>g||c===void 0)return 1;if(c<g||g===void 0)return-1}return a.index<b.index?-1:1}),"value")};var G=function(a,b,c,g){var e={},i=
E(b||h.identity);t(a,function(b,h){var z=i.call(c,b,h,a);g(e,z,b)});return e};h.groupBy=function(a,b,c){return G(a,b,c,function(a,b,c){(h.has(a,b)?a[b]:a[b]=[]).push(c)})};h.countBy=function(a,b,c){return G(a,b,c,function(a,b){h.has(a,b)||(a[b]=0);a[b]++})};h.sortedIndex=function(a,b,c,g){for(var c=c==null?h.identity:E(c),b=c.call(g,b),e=0,i=a.length;e<i;){var m=e+i>>>1;c.call(g,a[m])<b?e=m+1:i=m}return e};h.toArray=function(a){if(!a)return[];if(h.isArray(a))return g.call(a);if(a.length===+a.length)return h.map(a,
h.identity);return h.values(a)};h.size=function(a){if(a==null)return 0;return a.length===+a.length?a.length:h.keys(a).length};h.first=h.head=h.take=function(a,b,c){if(a!=null)return b!=null&&!c?g.call(a,0,b):a[0]};h.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))};h.last=function(a,b,c){if(a!=null)return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]};h.rest=h.tail=h.drop=function(a,b,c){return g.call(a,b==null||c?1:b)};h.compact=function(a){return h.filter(a,h.identity)};
var H=function(a,b,c){t(a,function(a){h.isArray(a)?b?j.apply(c,a):H(a,b,c):c.push(a)});return c};h.flatten=function(a,b){return H(a,b,[])};h.without=function(a){return h.difference(a,g.call(arguments,1))};h.uniq=h.unique=function(a,b,c,g){h.isFunction(b)&&(g=c,c=b,b=!1);var c=c?h.map(a,c,g):a,e=[],i=[];t(c,function(c,g){if(b?!g||i[i.length-1]!==c:!h.contains(i,c))i.push(c),e.push(a[g])});return e};h.union=function(){return h.uniq(m.apply(c,arguments))};h.intersection=function(a){var b=g.call(arguments,
1);return h.filter(h.uniq(a),function(a){return h.every(b,function(b){return h.indexOf(b,a)>=0})})};h.difference=function(a){var b=m.apply(c,g.call(arguments,1));return h.filter(a,function(a){return!h.contains(b,a)})};h.zip=function(){for(var a=g.call(arguments),b=h.max(h.pluck(a,"length")),c=Array(b),e=0;e<b;e++)c[e]=h.pluck(a,""+e);return c};h.object=function(a,b){if(a==null)return{};for(var c={},g=0,e=a.length;g<e;g++)b?c[a[g]]=b[g]:c[a[g][0]]=a[g][1];return c};h.indexOf=function(a,b,c){if(a==
null)return-1;var g=0,e=a.length;if(c)if(typeof c=="number")g=c<0?Math.max(0,e+c):c;else return g=h.sortedIndex(a,b),a[g]===b?g:-1;if(q&&a.indexOf===q)return a.indexOf(b,c);for(;g<e;g++)if(a[g]===b)return g;return-1};h.lastIndexOf=function(a,b,c){if(a==null)return-1;var g=c!=null;if(C&&a.lastIndexOf===C)return g?a.lastIndexOf(b,c):a.lastIndexOf(b);for(c=g?c:a.length;c--;)if(a[c]===b)return c;return-1};h.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0);for(var c=arguments[2]||1,g=Math.max(Math.ceil((b-
a)/c),0),e=0,h=Array(g);e<g;)h[e++]=a,a+=c;return h};h.bind=function(a,b){if(a.bind===F&&F)return F.apply(a,g.call(arguments,1));var c=g.call(arguments,2);return function(){return a.apply(b,c.concat(g.call(arguments)))}};h.partial=function(a){var b=g.call(arguments,1);return function(){return a.apply(this,b.concat(g.call(arguments)))}};h.bindAll=function(a){var b=g.call(arguments,1);b.length===0&&(b=h.functions(a));t(b,function(b){a[b]=h.bind(a[b],a)});return a};h.memoize=function(a,b){var c={};b||
(b=h.identity);return function(){var g=b.apply(this,arguments);return h.has(c,g)?c[g]:c[g]=a.apply(this,arguments)}};h.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};h.defer=function(a){return h.delay.apply(h,[a,1].concat(g.call(arguments,1)))};h.throttle=function(a,b){var c,g,e,h,i=0,m=function(){i=new Date;e=null;h=a.apply(c,g)};return function(){var k=new Date,j=b-(k-i);c=this;g=arguments;j<=0?(clearTimeout(e),e=null,i=k,h=a.apply(c,g)):e||
(e=setTimeout(m,j));return h}};h.debounce=function(a,b,c){var g,e;return function(){var h=this,i=arguments,m=c&&!g;clearTimeout(g);g=setTimeout(function(){g=null;c||(e=a.apply(h,i))},b);m&&(e=a.apply(h,i));return e}};h.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;c=a.apply(this,arguments);a=null;return c}};h.wrap=function(a,b){return function(){var c=[a];j.apply(c,arguments);return b.apply(this,c)}};h.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-
1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}};h.after=function(a,b){if(a<=0)return b();return function(){if(--a<1)return b.apply(this,arguments)}};h.keys=J||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)h.has(a,c)&&(b[b.length]=c);return b};h.values=function(a){var b=[],c;for(c in a)h.has(a,c)&&b.push(a[c]);return b};h.pairs=function(a){var b=[],c;for(c in a)h.has(a,c)&&b.push([c,a[c]]);return b};h.invert=function(a){var b={},c;for(c in a)h.has(a,c)&&(b[a[c]]=
c);return b};h.functions=h.methods=function(a){var b=[],c;for(c in a)h.isFunction(a[c])&&b.push(c);return b.sort()};h.extend=function(a){t(g.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]});return a};h.pick=function(a){var b={},e=m.apply(c,g.call(arguments,1));t(e,function(c){c in a&&(b[c]=a[c])});return b};h.omit=function(a){var b={},e=m.apply(c,g.call(arguments,1)),i;for(i in a)h.contains(e,i)||(b[i]=a[i]);return b};h.defaults=function(a){t(g.call(arguments,1),function(b){if(b)for(var c in b)a[c]==
null&&(a[c]=b[c])});return a};h.clone=function(a){if(!h.isObject(a))return a;return h.isArray(a)?a.slice():h.extend({},a)};h.tap=function(a,b){b(a);return a};var x=function(a,b,c,g){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;if(a instanceof h)a=a._wrapped;if(b instanceof h)b=b._wrapped;var e=k.call(a);if(e!=k.call(b))return!1;switch(e){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==
+b;case "[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;for(var i=c.length;i--;)if(c[i]==a)return g[i]==b;c.push(a);g.push(b);var i=0,m=!0;if(e=="[object Array]"){if(i=a.length,m=i==b.length)for(;i--;)if(!(m=x(a[i],b[i],c,g)))break}else{var e=a.constructor,j=b.constructor;if(e!==j&&(!h.isFunction(e)||!(e instanceof e&&h.isFunction(j)&&j instanceof j)))return!1;for(var p in a)if(h.has(a,
p)&&(i++,!(m=h.has(b,p)&&x(a[p],b[p],c,g))))break;if(m){for(p in b)if(h.has(b,p)&&!i--)break;m=!i}}c.pop();g.pop();return m};h.isEqual=function(a,b){return x(a,b,[],[])};h.isEmpty=function(a){if(a==null)return!0;if(h.isArray(a)||h.isString(a))return a.length===0;for(var b in a)if(h.has(a,b))return!1;return!0};h.isElement=function(a){return!!(a&&a.nodeType===1)};h.isArray=i||function(a){return k.call(a)=="[object Array]"};h.isObject=function(a){return a===Object(a)};t(["Arguments","Function","String",
"Number","Date","RegExp"],function(a){h["is"+a]=function(b){return k.call(b)=="[object "+a+"]"}});if(!h.isArguments(arguments))h.isArguments=function(a){return!(!a||!h.has(a,"callee"))};if(typeof/./!=="function")h.isFunction=function(a){return typeof a==="function"};h.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};h.isNaN=function(a){return h.isNumber(a)&&a!=+a};h.isBoolean=function(a){return a===!0||a===!1||k.call(a)=="[object Boolean]"};h.isNull=function(a){return a===null};h.isUndefined=
function(a){return a===void 0};h.has=function(a,b){return o.call(a,b)};h.noConflict=function(){a._=b;return this};h.identity=function(a){return a};h.times=function(a,b,c){for(var g=Array(a),e=0;e<a;e++)g[e]=b.call(c,e);return g};h.random=function(a,b){b==null&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var B={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};B.unescape=h.invert(B.escape);var K={escape:RegExp("["+h.keys(B.escape).join("")+"]","g"),unescape:RegExp("("+
h.keys(B.unescape).join("|")+")","g")};h.each(["escape","unescape"],function(a){h[a]=function(b){if(b==null)return"";return(""+b).replace(K[a],function(b){return B[a][b]})}});h.result=function(a,b){if(a==null)return null;var c=a[b];return h.isFunction(c)?c.call(a):c};h.mixin=function(a){t(h.functions(a),function(b){var c=h[b]=a[b];h.prototype[b]=function(){var a=[this._wrapped];j.apply(a,arguments);a=c.apply(h,a);return this._chain?h(a).chain():a}})};var L=0;h.uniqueId=function(a){var b=++L+"";return a?
a+b:b};h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var I=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\t|\u2028|\u2029/g;h.template=function(a,b,c){var g,c=h.defaults({},c,h.templateSettings),e=RegExp([(c.escape||I).source,(c.interpolate||I).source,(c.evaluate||I).source].join("|")+"|$","g"),i=0,m="__p+='";a.replace(e,function(b,c,g,e,h){m+=a.slice(i,h).replace(N,function(a){return"\\"+
M[a]});c&&(m+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'");g&&(m+="'+\n((__t=("+g+"))==null?'':__t)+\n'");e&&(m+="';\n"+e+"\n__p+='");i=h+b.length;return b});m+="';\n";c.variable||(m="with(obj||{}){\n"+m+"}\n");m="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+m+"return __p;\n";try{g=new Function(c.variable||"obj","_",m)}catch(k){throw k.source=m,k;}if(b)return g(b,h);b=function(a){return g.call(this,a,h)};b.source="function("+(c.variable||"obj")+"){\n"+
m+"}";return b};h.chain=function(a){return h(a).chain()};h.mixin(h);t(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=c[a];h.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);(a=="shift"||a=="splice")&&c.length===0&&delete c[0];return this._chain?h(c).chain():c}});t(["concat","join","slice"],function(a){var b=c[a];h.prototype[a]=function(){var a=b.apply(this._wrapped,arguments);return this._chain?h(a).chain():a}});h.extend(h.prototype,{chain:function(){this._chain=
!0;return this},value:function(){return this._wrapped}})}).call(this);(function(){var a={},b=window,e=b.document,c;a.disabled=!1;a.set=function(){};a.get=function(){};a.remove=function(){};a.clear=function(){};a.transact=function(b,c,g){var e=a.get(b);g==null&&(g=c,c=null);typeof e=="undefined"&&(e=c||{});g(e);a.set(b,e)};a.getAll=function(){};a.serialize=function(a){return JSON.stringify(a)};a.deserialize=function(a){if(typeof a=="string")return JSON.parse(a)};var i;try{i="localStorage"in b&&b.localStorage}catch(j){i=
!1}if(i)c=b.localStorage,a.set=function(b,g){if(g===void 0)return a.remove(b);c.setItem(b,a.serialize(g))},a.get=function(b){return a.deserialize(c.getItem(b))},a.remove=function(a){c.removeItem(a)},a.clear=function(){c.clear()},a.getAll=function(){for(var b={},g=0;g<c.length;++g){var e=c.key(g);b[e]=a.get(e)}return b};else{var g;try{g="globalStorage"in b&&b.globalStorage&&b.globalStorage[b.location.hostname]}catch(m){g=!1}if(g)c=b.globalStorage[b.location.hostname],a.set=function(b,g){if(g===void 0)return a.remove(b);
c[b]=a.serialize(g)},a.get=function(b){return a.deserialize(c[b]&&c[b].value)},a.remove=function(a){delete c[a]},a.clear=function(){for(var a in c)delete c[a]},a.getAll=function(){for(var b={},g=0;g<c.length;++g){var e=c.key(g);b[e]=a.get(e)}return b};else if(e.documentElement.addBehavior){var k,o;try{o=new ActiveXObject("htmlfile"),o.open(),o.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></frame>'),o.close(),k=o.w.frames[0].document,c=k.createElement("div")}catch(v){c=e.createElement("div"),
k=e.body}b=function(b){return function(){var g=Array.prototype.slice.call(arguments,0);g.unshift(c);k.appendChild(c);c.addBehavior("#default#userData");c.load("localStorage");g=b.apply(a,g);k.removeChild(c);return g}};a.set=b(function(b,c,g){c="_"+c;if(g===void 0)return a.remove(c);b.setAttribute(c,a.serialize(g));b.save("localStorage")});a.get=b(function(b,c){return a.deserialize(b.getAttribute("_"+c))});a.remove=b(function(a,b){a.removeAttribute("_"+b);a.save("localStorage")});a.clear=b(function(a){var b=
a.XMLDocument.documentElement.attributes;a.load("localStorage");for(var c=0,g;g=b[c];c++)a.removeAttribute(g.name);a.save("localStorage")});a.getAll=b(function(b){var c=b.XMLDocument.documentElement.attributes;b.load("localStorage");for(var b={},g=0,e;e=c[g];++g)b[e]=a.get(e);return b})}}try{a.set("__storejs__","__storejs__");if(a.get("__storejs__")!="__storejs__")a.disabled=!0;a.remove("__storejs__")}catch(u){a.disabled=!0}typeof module!="undefined"&&typeof module!="function"?module.exports=a:typeof define===
"function"&&define.amd?define(a):this.store=a})();(function(a,b){var e=function(a){this.defaults={locale_data:{messages:{"":{domain:"messages",lang:"en",plural_forms:"(n != 1);"}}},domain:"messages"};this.options=_.extend({},this.defaults,a);this.textdomain(this.options.domain);if(a.domain&&!this.options.locale_data[this.options.domain])throw Error("Text domain set to non-existent domain: `"+a.domain+"`");};e.context_delimiter=String.fromCharCode(4);var c=_.memoize(function(a){return _.partial(function(a,
b){var c=a(b);return c===!0?1:c?c:0},new Function("n","return "+(a||"(n != 1)")))});_.extend(e.prototype,{textdomain:function(a){if(!a)return this._textdomain;this._textdomain=a},gettext:function(a){return this.dcnpgettext.call(this,b,b,a)},dgettext:function(a,c){return this.dcnpgettext.call(this,a,b,c)},dcgettext:function(a,c){return this.dcnpgettext.call(this,a,b,c)},ngettext:function(a,c,g){return this.dcnpgettext.call(this,b,b,a,c,g)},dngettext:function(a,c,g,e){return this.dcnpgettext.call(this,
a,b,c,g,e)},dcngettext:function(a,c,g,e){return this.dcnpgettext.call(this,a,b,c,g,e)},pgettext:function(a,c){return this.dcnpgettext.call(this,b,a,c)},dpgettext:function(a,b,c){return this.dcnpgettext.call(this,a,b,c)},dcpgettext:function(a,b,c){return this.dcnpgettext.call(this,a,b,c)},npgettext:function(a,c,g,e){return this.dcnpgettext.call(this,b,a,c,g,e)},dnpgettext:function(a,b,c,e,k){return this.dcnpgettext.call(this,a,b,c,e,k)},dcnpgettext:function(a,b,g,m,k){m=m||g;a=a||this._textdomain;
k=typeof k=="undefined"?1:k;if(!this.options)return a=new e,a.dcnpgettext.call(a,void 0,void 0,g,m,k);if(!this.options.locale_data)throw Error("No locale data provided.");if(!this.options.locale_data[a])throw Error("Domain `"+a+"` was not found.");if(!this.options.locale_data[a][""])throw Error("No locale meta information provided.");if(!g)throw Error("No translation key found.");if(typeof k!="number"&&(k=parseInt(k,10),isNaN(k)))throw Error("The number that was passed in is not a number.");var b=
b?b+e.context_delimiter+g:g,o=this.options.locale_data[a],v=c(o[""].plural_forms)(k)+1;if(!o)throw Error("No domain named `"+a+"` could be found.");a=o[b];if(!a||v>=a.length)return this.options.missing_key_callback&&this.options.missing_key_callback(b),a=[null,g,m],a[c()(k)+1];a=a[v];if(!a)return a=[null,g,m],a[c()(k)+1];return a}});a.Jed=e})(this);r=window.r||{};r.setup=function(a){reddit=r.config=a;r.logging.init();r.config.currentOrigin=location.protocol+"//"+location.host;r.analytics.breadcrumbs.init()};
r.ajax=function(a){var b=a.url;if(a.type=="GET"&&_.isEmpty(a.data)){var e=r.preload.read(b);if(e!=null)return a.dataFilter&&(e=a.dataFilter(e,"json")),a.success(e),a=new jQuery.Deferred,a.resolve(e),a}if(b&&(b[0]=="/"||b.lastIndexOf(r.config.currentOrigin,0)==0)){if(!a.headers)a.headers={};a.headers["X-Modhash"]=r.config.modhash}return $.ajax(a)};r.sync=function(a,b,e){var c=e.dataFilter;e.dataFilter=function(a,b){var g;g=b==="json"?r.utils.unescapeJson(a):a;return c?c(g):g};return r.backboneSync.call(Backbone,
a,b,e)};store.safeGet=function(a,b){if(store.disabled)return b;try{return store.get(a)}catch(e){return r.sendError('Unable to read storage key "%(key)s" (%(err)s)'.format({key:a,err:e})),b}};store.safeSet=function(a,b){if(store.disabled)return!1;try{return store.set(a,b),!0}catch(e){return r.warn('Unable to set storage key "%(key)s" (%(err)s)'.format({key:a,err:e})),!1}};r.setupBackbone=function(){Backbone.emulateJSON=!0;Backbone.ajax=r.ajax;if(!r.backboneSync)r.backboneSync=Backbone.sync,Backbone.sync=
r.sync};$(function(){try{r.setupBackbone(),r.login.ui.init(),r.analytics.init(),r.ui.init(),r.interestbar.init(),r.visited.init(),r.apps.init(),r.wiki.init(),r.gold.init(),r.multi.init(),r.recommend.init(),r.saved.init()}catch(a){r.sendError("Error during base.js init",a)}});r.preload={timestamp:new Date,maxAge:3E5,data:{},isExpired:function(){return new Date-this.timestamp>this.maxAge},set:function(a){_.extend(this.data,a)},read:function(a){var b=this.data[a];if(a[0]=="#")return b;if(!this.isExpired())return b}};
r.logging={};r.logging.pageAgeLimit=300;r.logging.sendThrottle=8;r.logging.exceptionMessageTemplate=_.template('Client Error: "<%= errorType %>" thrown at L<%= line %>:<%= character %> in <%= file %> Message: "<%= message %>"');r.logging.defaultExceptionValues={message:"UNKNOWN MESSAGE",file:"UNKNOWN FILE",line:"?",character:"?",errorType:"UNKNOWN ERROR TYPE"};r.logging.sendException=function(a){if(!a)throw"No exception object was passed in.";_.defaults(a,r.logging.defaultExceptionValues);a=r.logging.exceptionMessageTemplate(a);
r.logging.sendError(a,{tag:"unknown"})};r.logging.init=function(){_.each(["debug","log","warn","error"],function(a){r[a]=(a!="debug"||r.config.debug)&&window.console&&console[a]?_.bind(console[a],console):function(){}});r.sendError=r.logging.sendError};r.logging.serverLogger={logCount:0,_queuedLogs:[],queueLog:function(a){if(r.config){if(!r.warn)r.warn=function(){};if(this.logCount>=3)r.warn("Not sending debug log; already sent",this.logCount);else{var b=new Date/1E3-r.config.server_time;Math.abs(b)>
r.logging.pageAgeLimit?r.warn("Not sending debug log; page too old:",b):r.config.send_logs?(a.url=window.location.toString(),this._queuedLogs.push(a),this.logCount++,_.defer(_.bind(function(){this._sendLogs()},this))):r.warn("Server-side debug logging disabled")}}},_sendLogs:_.throttle(function(){var a=this._queuedLogs.length;r.ajax({type:"POST",url:"/web/log/error.json",data:{logs:JSON.stringify(this._queuedLogs)},headers:{"X-Loggit":!0},success:function(){r.log("Sent",a,"debug logs to server")},
error:function(a,e,c){r.warn("Error sending debug logs to server:",e,";",c)}});this._queuedLogs=[]},r.logging.sendThrottle*1E3)};r.logging.sendError=function(){var a=_.toArray(arguments),b=_.last(a),e={};_.isObject(b)&&(e=b,a.pop());a=_.defaults({msg:a.join(" ")},e);r.error&&r.error.apply(r,arguments);r.logging.serverLogger.queueLog(a)};(function(a,b,e){var c=a.onerror;a.onerror=function(b,j,g,m,k){var o=/((^Script error\.$)|(atomicFindClose))/i;!/^(chrome:\/\/|file:\/\/)/i.test(j)&&!o.test(b)&&(e.logging.sendException({message:b,
file:j,line:g,character:m,errorType:k}),c&&c.apply(a,arguments))}})(this,jQuery,r,_);(function(a,b){function e(a){b.sendError(a,{tag:"jquery-migrate-bad-html"})}var c=a.fn.init,i=/^([^<]*)(<[\w\W]+>)([^>]*)$/;a.fn.init=function(b,g,m){var k;if(b&&typeof b==="string"&&!a.isPlainObject(g)&&(k=i.exec(a.trim(b)))&&k[0]){b.charAt(0)!=="<"&&e('$(html) HTML strings must start with "<" character');k[3]&&e("$(html) HTML text after last tag is ignored");k[0].charAt(0)==="#"&&e('HTML string cannot start with a "#" character');
if(g&&g.context)g=g.context;if(a.parseHTML)return c.call(this,a.parseHTML(b,g,!0),g,m)}return c.apply(this,arguments)};a.fn.init.prototype=a.fn})(jQuery,r);r.ui={};r.ui.Base=function(a){this.$el=$(a)};r.ui.collapsibleSideBox=function(a){var b=$("#"+a);return new r.ui.Collapse(b.find(".title"),b.find(".content"),a)};r.ui.Collapse=function(a,b,e){r.ui.Base.call(this,a);this.target=b;this.key="ui.collapse."+e;this.isCollapsed=store.safeGet(this.key)==!0;this.$el.click($.proxy(this,"toggle",null,!1));
this.toggle(this.isCollapsed,!0)};r.ui.Collapse.prototype={animDuration:200,toggle:function(a,b){a==null&&(a=!this.isCollapsed);var e=b?0:this.animDuration;a?$(this.target).slideUp(e):$(this.target).slideDown(e);this.isCollapsed=a;store.safeSet(this.key,a);this.update()},update:function(){this.$el.find(".collapse-button").text(this.isCollapsed?"+":"-")}};r.ui.Summarize=function(a,b){r.ui.Base.call(this,a);this.maxCount=b;this._updateItems();if(this.$hiddenItems.length>0)this.$toggleButton=$('<button class="expand-summary">').click($.proxy(this,
"_toggle")),this.$el.after(this.$toggleButton),this._summarize()};r.ui.Summarize.prototype={_updateItems:function(){var a=this.$el.children(".important"),b=this.$el.children(":not(.important)"),e=this.maxCount?Math.max(0,this.maxCount-a.length):0,c=b.slice(0,e-1);this.$summaryItems=a.add(c);this.$hiddenItems=b.slice(e)},_summarize:function(){this.$el.addClass("summarized");this.$hiddenItems.hide();this.$toggleButton.html(r._("&hellip; and %(count)s more &rArr;").format({count:this.$hiddenItems.length}))},
_expand:function(){this.$el.removeClass("summarized");this.$hiddenItems.show();this.$toggleButton.html(r._("&lArr; less"))},_toggle:function(a){this.$el.hasClass("summarized")?this._expand():this._summarize();a.preventDefault()}};r.ui.setSavedFullname=function(a){a=$(".id-"+a).find(".save-button a").first();a.text(r._("unsave"));a.thing().addClass("saved")};r.i18n={jed:new Jed({locale_data:{messages:{"":{domain:"messages",lang:"en"}}}}),setPluralForms:function(a){this.jed.options.locale_data.messages[""].plural_forms=
a},addMessages:function(a){_.extend(this.jed.options.locale_data.messages,a)}};r._=_.bind(r.i18n.jed.gettext,r.i18n.jed);r.P_=_.bind(r.i18n.jed.ngettext,r.i18n.jed);r.N_=_.identity;r.NP_=function(a,b){return[a,b]};r.utils={clamp:function(a,b,e){return Math.max(b,Math.min(e,a))},staticURL:function(a){return r.config.static_root+"/"+a},s3HTTPS:function(a){return location.protocol=="https:"?a.replace("http://","https://s3.amazonaws.com/"):a},joinURLs:function(){return _.map(arguments,function(a,b){b>
0&&a&&a[0]!="/"&&(a="/"+a);return a}).join("")},tup:function(a){_.isArray(a)||(a=[a]);return a},structuredMap:function(a,b){if(_.isArray(a))return _.map(a,function(a){return r.utils.structuredMap(a,b)});else if(_.isObject(a)){var e={};_.each(a,function(a,i){e[b(i,"key")]=r.utils.structuredMap(a,b)});return e}else return b(a,"value")},unescapeJson:function(a){return r.utils.structuredMap(a,function(a){return _.isString(a)?_.unescape(a):a})},querySelectorFromEl:function(a,b){return $(a).parents().addBack().filter(b||
"*").map(function(a,b){var i=[],j=$(b),g=j.data("fullname"),m=j.attr("id"),j=j.attr("class");i.push(b.nodeName.toLowerCase());g?i.push('[data-fullname="'+g+'"]'):m?i.push("#"+m):j&&i.push("."+_.compact(j.split(/\s+/)).join("."));return i.join("")}).toArray().join(" ")},serializeForm:function(a){var b={};$.each(a.serializeArray(),function(a,c){b[c.name]=c.value});return b},_pyStrFormatRe:/%\((\w+)\)s/g,pyStrFormat:function(a,b){return a.replace(this._pyStrFormatRe,function(a,c){if(!(c in b))throw"missing format parameter";
return b[c]})},_mdLinkRe:/\[(.*?)\]\((.*?)\)/g,formatMarkdownLinks:function(a){return _.escape(a).replace(this._mdLinkRe,function(a,e,c){return'<a href="'+c+'">'+e+"</a>"})},prettyNumber:function(a){var b=parseInt(a);return b?b.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):a},LRUCache:function(a){var b=a>0?a:16,e=[],c={},i=function(a){j(a);e.push(a);e.length>b&&delete c[e.shift()]},j=function(a){a=_.indexOf(e,a);a>=0&&e.splice(a,1)};this.remove=function(a){j(a);delete c[a]};this.set=function(a,
b){_.isUndefined(b)?this.remove(a):(c[a]=b,i(a))};this.get=function(a){var b=c[a];_.isUndefined(b)||i(a);return b};this.ajax=function(a,b){var c=this.get(a);return _.isUndefined(c)?$.ajax(b).done(_.bind(this.set,this,a)):(new $.Deferred).resolve(c)}}};String.prototype.format=function(a){return r.utils.pyStrFormat(this,a)};r.analytics={trackers:{},_pendingTrackers:{},init:function(){$(document).delegate(".organic-listing .promotedlink.promoted, .comments-page .promotedlink.promoted, .linklisting .promotedlink.promoted",
"onshow",_.bind(function(a){this.fetchTrackersOrFirePixel(a.target)},this));$(".promotedlink.promoted:visible").trigger("onshow");$("form.gold-checkout").one("submit",this.fireGoldCheckout)},fetchTrackingHash:function(a){var b=$(a),a=b.data("fullname"),b=b.data("cid");a+="-"+(b||"");r.config.is_fake||(a+="-"+r.config.post_site);a in this.trackers||(this._pendingTrackers[a]=this.trackers[a]=new $.Deferred,this.fetchTrackingHashes());return this.trackers[a]},fetchTrackingHashes:_.debounce(function(){var a=
this._pendingTrackers;$.ajax({url:r.config.fetch_trackers_url,type:"get",dataType:"jsonp",data:{ids:_.keys(a)},success:function(b){_.each(b,function(b,c){a[c].resolve(c,b)})}});this._pendingTrackers={}},0),fetchTrackersOrFirePixel:function(a){this.fetchTrackingHash(a).done(_.bind(function(b,e){this.fireTrackingPixel(a,b,e)},this))},fireTrackingPixel:function(a,b,e){a=$(a);if(!a.data("trackerFired")){var c=a.parent().hasClass("organic-listing"),i=$("body").hasClass("comments-page");if(c||i)if((new Image).src=
r.config.adtracker_url+"?"+$.param({id:b,hash:e,r:Math.round(Math.random()*2147483647)}),c=new Image,i=a.data("adserverImpPixel"),a.data("adserverClickUrl"),i)c.src=i;var c=a.find("a.title"),i=c.html(),j=c.attr("href"),b=r.config.clicktracker_url+"?"+$.param({id:b,hash:e,url:j});save_href(c);c.attr("href",b);c.html()!=i&&c.html(i);e=a.find("a.thumbnail");save_href(e);e.attr("href",b);a.hasClass("self")&&(e=a.find("a.comments"),save_href(e),e.attr("href",b));a.data("trackerFired",!0)}},fireUITrackingPixel:function(a,
b,e){(new Image).src=r.config.uitracker_url+"?"+$.param(_.extend({act:a,sr:b,r:Math.round(Math.random()*2147483647)},r.analytics.breadcrumbs.toParams(),e))},fireGoldCheckout:function(a){var b=$(this),e=b.data("vendor");b.parent().addClass("working");_gaq.push(["_trackPageview","/gold/external/"+e]);_gaq.push(function(){setTimeout(function(){b.submit()},500)});_gat&&_gat._getTracker&&a.preventDefault()}};r.analytics.breadcrumbs={selector:".thing, .side, .sr-list, .srdrop, .tagline, .md, .organic-listing, .gadget, .sr-interest-bar, .trending-subreddits, a, button, input",
maxLength:3,sendLength:2,init:function(){this.hasSessionStorage=this._checkSessionStorage();this.data=this._load();this.data[0]&&this.data[0].url==window.location||this._storeBreadcrumb();$(document).delegate("a, button","click",$.proxy(function(a){this.storeLastClick($(a.target))},this))},_checkSessionStorage:function(){try{return sessionStorage.setItem("__test__","test"),sessionStorage.removeItem("__test__"),!0}catch(a){return!1}},_load:function(){if(!this.hasSessionStorage)return[{stored:!1}];
var a;try{a=JSON.parse(sessionStorage.breadcrumbs)}catch(b){a=[]}_.isArray(a)||(a=[]);return a},store:function(){this.hasSessionStorage&&(sessionStorage.breadcrumbs=JSON.stringify(this.data))},_storeBreadcrumb:function(){var a={url:location.toString()};if("referrer"in document){var b=!document.referrer.match("^"+r.config.currentOrigin),e=this.data[0]&&document.referrer!=this.data[0].url;if(b||e)a.ref=document.referrer}this.data.unshift(a);this.data=this.data.slice(0,this.maxLength);this.store()},
storeLastClick:function(a){try{this.data[0].click=r.utils.querySelectorFromEl(a,this.selector),this.store()}catch(b){}},lastClickFullname:function(){var a=_.find(this.data,function(a){return a.click});if(a)return(a=a.click.match(/.*data-fullname="(\w+)"/))&&a[1]},toParams:function(){params=[];for(var a=0;a<this.sendLength;a++)_.each(this.data[a],function(b,e){params["c"+a+"_"+e]=b});return params}};(function(a){function b(){return function(b){if(b.jquery){var c={};c[0]=jQuery;a.map(b.jquery,function(b){var g=
b[0],e=b[1],i=b[2],b=b[3];if(typeof b=="string")b=a.unsafe(b);else for(var j=0;b.length&&j<b.length;j++)b[j]=a.unsafe(b[j]);i=="call"?c[e]=c[g].apply(c[g]._obj,b):i=="attr"?(c[e]=c[g][b],c[e]?c[e]._obj=c[g]:a.debug("unrecognized")):i=="refresh"?a.refresh():a.debug("unrecognized")})}}}a.log=function(a){window.console?window.console.debug?window.console.debug(a):window.console.log&&window.console.log(a):alert(a)};a.debug=function(b){if(a.with_default(reddit.debug,!1))return a.log(b)};a.fn.debug=function(){a.debug(a(this));
return a(this)};a.redirect=function(a){window.location=a};a.fn.redirect=function(b){a(this).filter("form").find(".status").show().html("redirecting...");if(a(this).attr("target")=="_top"){for(var c=window;c!=c.parent;)c=c.parent;c.location=b}else a.redirect(b);return a(this)};a.refresh=function(){window.location.reload(!0)};a.defined=function(a){return typeof a!="undefined"};a.with_default=function(b,c){return a.defined(b)?b:c};a.websafe=function(a){typeof a=="string"&&(a=a.replace(/&/g,"&amp;").replace(/"/g,
"&quot;").replace(/>/g,"&gt;").replace(/</g,"&lt;"));return a||""};a.unsafe=function(a){typeof a=="string"&&(a=a.replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"));return a||""};a.uniq=function(a,b){for(var c=[],e={},i=b?b:a.length,j=0;j<a.length&&c.length<i;j++)e[a[j]]||(e[a[j]]=!0,c.push(a[j]));return c};(function(b,c){a.fn.show=function(c,e){a(this).trigger("onshow");return b.call(this,c,e)};a.fn.hide=function(b,e){a(this).trigger("onhide");return c.call(this,
b,e)}})(a.fn.show,a.fn.hide);var e={};a.handleResponse=b;a.request=function(c,i,k,j,v,u,p){var n=c,s=k;if(rate_limit(c))p&&p("ratelimit");else if(window==window.top||reddit.external_frame){if(!(s=!a.with_default(j,!1)))s=e[n]?!1:e[n]=!0;j=s;i=a.with_default(i,{});k=a.with_default(k,b(n));v=a.with_default(v,"json");typeof k!="function"&&(k=b(n));s=function(a){delete e[n];return k(a)};errorhandler_in=a.with_default(p,function(){});p=function(a){delete e[n];return errorhandler_in(a)};u=a.with_default(u,
!1);if(reddit.post_site)i.r=reddit.post_site;if(reddit.logged)i.uh=reddit.modhash;i.renderstyle=reddit.renderstyle;j&&a.ajax({type:u?"GET":"POST",url:"/api/"+c,data:i,success:s,error:p,dataType:v})}};rate_limit=function(){var a={vote:333,comment:5E3,ignore:0,ban:0,unban:0,assignad:0},b={},c=Date;return function(e){var i=new c,j=e in a?a[e]:333,p=b[e];b[e]=i;return p&&i-p<j}}();a.fn.vote=function(b,c,e,i){if(reddit.logged&&a(this).hasClass("arrow")){var j=a(this).hasClass("up")?1:a(this).hasClass("down")?
-1:0,u=a(this).all_things_by_id(),p=u.children().not(".child").find(".arrow"),n=j==1?"up":"upmod";p.filter("."+n).removeClass(n).addClass(j==1?"upmod":"up");n=j==-1?"down":"downmod";p.filter("."+n).removeClass(n).addClass(j==-1?"downmod":"down");reddit.logged&&(u.each(function(){var b=a(this).find(".entry:first, .midcol:first");j>0?b.addClass("likes").removeClass("dislikes unvoted"):j<0?b.addClass("dislikes").removeClass("likes unvoted"):b.addClass("unvoted").removeClass("likes dislikes")}),a.defined(i)||
(i=u.filter(":first").thing_id(),b+=e?"":"-"+i,a.request("vote",{id:i,dir:j,vh:b})));c&&c(u,j)}};a.fn.show_unvotable_message=function(){a(this).thing().find(".entry:first .unvotable-message").css("display","inline-block")};a.fn.thing=function(){return this.parents(".thing:first")};a.fn.all_things_by_id=function(){return this.thing().add(a.things(this.thing_id()))};a.fn.thing_id=function(b){var b=a.with_default(b,"thing"),c=this.hasClass("thing")?this:this.thing();b!="thing"&&(c=c.find("."+b+":first"));
if(c.length)return b=a.grep(c.get(0).className.match(/\S+/g),function(a){return a.match(/^id-/)}),b.length?b[0].slice(3,b[0].length):"";return""};a.things=function(){var b=a.map(arguments,function(a){return".thing.id-"+a}).join(", ");return a(b)};a.fn.same_author=function(){var b=a(this).thing_id("author"),c=[];a(".author.id-"+b).each(function(){c.push(".thing.id-"+a(this).thing_id())});return a(c.join(", "))};a.fn.things=function(){return this.find(a.map(arguments,function(a){return".thing.id-"+
a}).join(", "))};a.listing=function(b){b=b||"";if(b.slice(0,1)=="#"||b.slice(0,1)==".")b=b.slice(1,b.length);var c=b;b.slice(0,9)!="siteTable"?c="siteTable"+(b?"_"+b:""):b=b.slice(10,b.length);var e=a("#"+c).filter(":first");e.length==0&&(e=a.things(b).find(".child").append(document.createElement("div")).children(":last").addClass("sitetable").attr("id",c));return e};var c=function(){};a.fn.set_thing_init=function(b){c=b;a(this).find(".thing:not(.stub)").each(function(){b(this)})};a.fn.new_thing_child=
function(b,c){var e=this.thing_id(),i=c?a.listing(e):this.thing().find(".child:first");return(typeof b=="string"?i.prepend(b).children(":first"):b.hide().prependTo(i).show().find('input[name="parent"]').val(e).end()).randomize_ids()};a.fn.randomize_ids=function(){var b=(Math.random()+"").split(".")[1];a(this).find("*[id]").each(function(){a(this).attr("id",a(this).attr("id")+b)}).end().find("label").each(function(){a(this).attr("for",a(this).attr("for")+b)});return a(this)};a.fn.replace_things=function(b,
e,i,j){var v=this,b=a.map(b,function(b){var g=b.data,b=a(v).things(g.id);j&&(b=b.filter(".stub"));if(b.length==0){var n=a.things(g.parent);n.length&&(b=a("<div></div>"),n.find(".child:first").append(b))}b.after(a.unsafe(g.content));g=b.next();e&&(g.show().children(".midcol, .entry").hide().end().children(".child:first").html(b.children(".child:first").remove().html()).end(),i&&(b.hide(),g.children(".midcol, .entry").show()),g.find(".rank:first").html(b.find(".rank:first").html()));i?(b.hide(),e?g.children(".midcol, .entry").show():
g.show()):g.hide();b.remove();c(g);a(document).trigger("new_thing",g);return g});a(document).trigger("new_things_inserted");return b};a.insert_things=function(b,e){var i=a.map(b,function(b){var b=b.data,g=a.listing(b.parent),g=e?g.append(a.unsafe(b.content)).children(".thing:last"):g.prepend(a.unsafe(b.content)).children(".thing:first");c(g.hide().show());a(document).trigger("new_thing",g);return g});a(document).trigger("new_things_inserted");return i};a.fn.delete_table_row=function(b){var c=this.parents("tr:first").get(0),
e=this.parents("table").get(0);c?a(c).fadeOut(function(){e.deleteRow(c.rowIndex);b&&b()}):b&&b()};a.fn.insert_table_rows=function(b,c){var e=this.is("table")?this.filter("table"):this.parents("table:first");a.map(e.get(),function(e){a.map(b,function(b){var g=c;g<0&&(g=Math.max(e.rows.length+g+1,0));var g=Math.min(g,e.rows.length),i=e.insertRow(g);a(i).hide().attr("id",b.id).addClass(b.css_class);a.map(b.cells,function(b){a(i.insertCell(i.cells.length)).html(a.unsafe(b)).trigger("insert-cell")});a(i).trigger("insert-row");
a(i).fadeIn()})});return this};a.fn.captcha=function(a){var b=this.find(".capimage");a&&b.attr("src","/captcha/"+a+".png").parents("form").find('input[name="iden"]').val(a);return b};a.fn.insertAtCursor=function(b){return a(this).filter("textarea").each(function(){var c=a(this).get(0),e=c.scrollTop;if(document.selection)c.focus(),document.selection.createRange().text=b;else if(c.selectionStart){var i=c.selectionStart;c.value=c.value.substring(0,c.selectionStart)+b+c.value.substring(c.selectionEnd,
c.value.length);i+=b.length;c.setSelectionRange(i,i)}else c.value+=b;if(c.scrollHeight)c.scrollTop=e;a(this).focus()}).end()};a.fn.select_line=function(b){return a(this).filter("textarea").each(function(){var c="\n",e=1,i=0;/msie [\w.]+/.exec(navigator.userAgent.toLowerCase())&&(c="\r",e=0,i=1);for(var c=a(this).val().split(c),j=0;j<b-1;j++)i+=c[j].length+e;j=i;b<=c.length&&(j+=c[b-1].length+e);a(this).focus();this.createTextRange?(e=this.createTextRange(),e.move("character",i),i=this.createTextRange(),
i.move("character",j),e.setEndPoint("StartToEnd",i),e.select()):this.selectionStart&&this.setSelectionRange(i,j);if(this.scrollHeight)this.scrollTop=(b-2)*(this.scrollHeight/c.length)})};a.apply_stylesheet=function(b){var c=a("head").children("link[title], style[title]").filter(":first").attr("title")||"preferred stylesheet";if(document.styleSheets[0].cssText)for(var e=document.styleSheets,i=0;i<e.length;i++){if(e[i].title==c){e[i].cssText=b;break}}else a("head").children('*[title="'+c+'"]').remove(),
a('<style type="text/css" media="screen"></style>').attr("title",c).text(b).appendTo("head")};a.rehighlight_new_comments=function(){checked=a(".comment-visits-box input:checked");checked.length>0&&highlight_new_comments(checked[0].value)};var i;a.default_cookie_domain=function(a){a&&(i=a)};var j="_";a.cookie_name_prefix=function(a){a&&(j=a+"_")};a.cookie_write=function(b){if(b.name){var c={};c.expires=b.expires;c.domain=b.domain||i;c.path=b.path||"/";var e=j+b.name,b=b.data;b===null||b==""?b=null:
typeof b!="string"&&(b=JSON.stringify(b));a.cookie(e,b,c)}};a.cookie_read=function(b,c){var e=a.cookie((c||j)+b);try{e=JSON.parse(e)}catch(i){}return{name:b,data:e}}})(jQuery);var open_menu=function(a){$(a).siblings(".drop-choices").not(".inuse").css("top",a.offsetHeight+"px").each(function(){$(this).css("left",$(a).position().left+"px").css("top",$(a).height()+$(a).position().top+"px")}).addClass("active inuse")},close_menus=function(a){$(".drop-choices.inuse").not(".active").removeClass("inuse");
$(".drop-choices.active").removeClass("active").trigger("close_menu");$(".flairselector").empty();$(a.target).closest("#search").length==0&&($("#moresearchinfo").slideUp(),$("#searchexpando").length==1?$("#searchexpando").slideUp(function(){$("#search_showmore").parent().show()}):$("#search_showmore").parent().show())},hover_open_menu=function(){},select_tab_menu=function(a,b){var e="tabbedpane-"+b,c=$(a).parent().parent().parent();c.find(".tabmenu li").removeClass("selected");$(a).parent().addClass("selected");
c.find(".tabbedpane").each(function(){this.style.display=this.id==e?"block":"none"})},update_user=function(a){try{var b=$(a).find('input[name="user"]').val();a.action+="/"+b}catch(e){}return!0},post_user=function(a,b){var e=$(a).find('input[name="user"]').val();return e==null?post_form(a,b):post_form(a,b+"/"+e)},post_form=function(a,b,e,c,i){try{return e==null&&(e=function(){return reddit.status_msg.submitting}),$(a).find(".error").not(".status").hide(),$(a).find(".status").html(e(a)).show(),simple_post_form(a,
b,{},i)}catch(j){return!1}},get_form_fields=function(a,b,e){b=b||{};e||(e=function(){return!0});$(a).find("select, input, textarea").not(".gray, :disabled").each(function(){var a=$(this),i=a.attr("type");if(e(this))if(a.data("send-checked"))b[a.attr("name")]=a.is(":checked");else if(i!="radio"&&i!="checkbox"||a.is(":checked"))b[a.attr("name")]=a.val()});if(b.id==null)b.id=$(a).attr("id")?"#"+$(a).attr("id"):"";return b},form_error=function(a){return function(b){b=b=="ratelimit"?r._("please wait a few seconds and try again."):
r._("an error occurred (status: %(status)s)").format({status:b.status});$(a).find(".status").text(b)}},simple_post_form=function(a,b,e,c,i){$.request(b,get_form_fields(a,e),i,c,"json",!1,form_error(a));return!1},post_pseudo_form=function(a,b,e){$(a).find(".error").not(".status").hide();$(a).find(".status").html(reddit.status_msg.submitting).show();$.request(b,get_form_fields(a,{},function(b){b=$(b).parents("form:first");return b.length==0||b.get(0)==$(a).get(0)}),null,e,"json",!1,form_error(a));return!1},
post_multipart_form=function(a){$(a).find(".error").not(".status").hide();$(a).find(".status").html(reddit.status_msg.submitting).show();return!0},emptyInput=function(a,b){!$(a).val()||$(a).val()==b?$(a).addClass("gray").val(b).attr("rows",3):$(a).focus(function(){})},showlang=function(){$(".lang-popup:first").show();return!1},hidecover=function(a){$(a).parents(".cover-overlay").hide();return!1},deleteRow=function(a){$(a).delete_table_row()},change_state=function(a,b,e,c,i){var j=$(a).parents("form").first(),
g=j.find('input[name="id"]'),g=g.length?g.val():$(a).thing_id();simple_post_form(j,b,{id:g},void 0,i);e&&e(j.length?j:a,b);$.defined(c)||j.html(j.find('[name="executed"]').val());return!1},unread_thing=function(a){a=$(a);a.hasClass("thing")||(a=a.thing());$(a).addClass("new unread")},read_thing=function(a){a=$(a);a.hasClass("thing")||(a=a.thing());$(a).hasClass("new")?$(a).removeClass("new"):$(a).removeClass("unread");$.request("read_message",{id:$(a).thing_id()})},save_thing=function(a){$(a).thing().addClass("saved")},
unsave_thing=function(a){$(a).thing().removeClass("saved")},click_thing=function(a){var b=$(a);b.hasClass("thing")||(b=b.thing());b.hasClass("message")&&b.hasClass("recipient")&&(b.hasClass("unread")?b.removeClass("unread"):b.hasClass("new")&&read_thing(a))},hide_thing=function(a){$(a).thing().fadeOut(function(){$(this).toggleClass("hidden");unexpando_child(a)})},toggle_label=function(a,b,e){$(a).parent().find(".option").toggle();$(a)[0].onclick=function(){return toggle_label(a,e,b)};b&&b(a)},toggle=
function(a,b,e){r.analytics.breadcrumbs.storeLastClick(a);var c=$(a).parent().addBack().filter(".option").removeClass("active").siblings().addClass("active").get(0);if(e&&!c.onclick)c.onclick=function(){return toggle(c,e,b)};b&&b(a);return!1},cancelToggleForm=function(a,b,e,c){e&&$(a).filter("button").length&&(e=$(a).thing().find(e).children(":visible").filter(":first"),toggle(e));$(a).thing().find(b).each(function(){c&&c($(this));$(this).hide().remove()});return!1},linkstatus=function(){return reddit.status_msg.submitting},
subscribe=function(a){return function(){reddit.logged&&(reddit.cur_site==a&&$("body").addClass("subscriber"),$.things(a).find(".entry").addClass("likes"),$.request("subscribe",{sr:a,action:"sub"}),r.analytics.fireUITrackingPixel("sub",a,{has_subd:r.config.has_subscribed}))}},unsubscribe=function(a){return function(){reddit.logged&&(reddit.cur_site==a&&$("body").removeClass("subscriber"),$.things(a).find(".entry").removeClass("likes"),$.request("subscribe",{sr:a,action:"unsub"}),r.analytics.fireUITrackingPixel("unsub",
a))}},friend=function(a,b,e){return function(){reddit.logged&&(encoded=encodeURIComponent(document.referrer),$.request("friend?note="+encoded,{name:a,container:b,type:e}))}},unfriend=function(a,b,e){return function(){$.request("unfriend",{name:a,container:b,type:e})}},share=function(a){$.request("new_captcha");$(a).new_thing_child($(".sharelink:first").clone(!0).attr("id","sharelink_"+$(a).thing_id()),!1);$.request("new_captcha")},cancelShare=function(a){return cancelToggleForm(a,".sharelink",".share-button")},
reject_promo=function(a){$(a).thing().find(".rejection-form").show().find("textare").focus()},cancel_reject_promo=function(a){$(a).thing().find(".rejection-form").hide()},complete_reject_promo=function(a){$(a).thing().removeClass("accepted").addClass("rejected").find(".reject_promo").remove()},helpon=function(a){$(a).parents(".usertext-edit:first").children(".markhelp:first").show()},helpoff=function(a){$(a).parents(".usertext-edit:first").children(".markhelp:first").hide()},show_all_messages=function(a){var b=
[];$(a).parents(".message").find(".entry .collapsed").hide().end().find(".noncollapsed, .midcol:first").filter(":hidden").each(function(){var a=$(this).show().thing_id();b.indexOf(a)==-1&&b.push(a)});b.length&&$.request("uncollapse_message",{id:b.join(",")});return!1},hide_all_messages=function(a){var b=[];$(a).parents(".message").find(".entry .collapsed").show().end().find(".noncollapsed, .midcol:first").filter(":visible").each(function(){var a=$(this).hide().thing_id();b.indexOf(a)==-1&&b.push(a)});
b.length&&$.request("collapse_message",{id:b.join(",")});return!1},hidecomment=function(a){a=$(a).thing();a.hide().find(".noncollapsed:first, .midcol:first").hide().end().show().find(".entry:first .collapsed").show();a.hasClass("message")?$.request("collapse_message",{id:$(a).thing_id()}):a.find(".child:first").hide();return!1},showcomment=function(a){a=$(a).thing();a.find(".entry:first .collapsed").hide().end().find(".noncollapsed:first, .midcol:first").show().end().show();a.hasClass("message")?
$.request("uncollapse_message",{id:$(a).thing_id()}):a.find(".child:first").show();return!1},morechildren=function(a,b,e,c,i){$(a).html(reddit.status_msg.loading).css("color","red");a=$(a).parents(".thing.morechildren:first").thing_id();$.request("morechildren",{link_id:b,children:e,depth:c,id:a,pv_hex:i});return!1},moremessages=function(a){$(a).html(reddit.status_msg.loading).css("color","red");$.request("moremessages",{parent_id:$(a).thing_id()});return!1},add_thing_to_cookie=function(a,b){var e=
$(a).thing_id();if(e&&e.length)return add_thing_id_to_cookie(e,b)},add_thing_id_to_cookie=function(a,b){var e=$.cookie_read(b);if(!e.data)e.data="";if(e.data.substring(0,a.length)!=a){e.data=a+","+e.data;var c=e.data.split(",");if(c.length>5)c=$.uniq(c,5),e.data=c.join(",");$.cookie_write(e)}},clicked_items=function(){var a=$.cookie_read("recentclicks2");if(a&&a.data){for(var a=a.data.split(","),b=a.length-1;b>=0;b--)(!a[b]||!a[b].length)&&a.splice(b,1);return a}else return[]},clear_clicked_items=
function(){var a=$.cookie_read("recentclicks2");a.data="";$.cookie_write(a);$(".gadget").remove()},updateEventHandlers=function(a){var a=$(a),b=a.parent();$(a).filter(".link").find("a.title, a.comments").mousedown(function(){add_thing_to_cookie(this,"recentclicks2")});b.filter(".organic-listing").length&&(a.find(".hide-button a, .del-button a.yes, .report-button a.yes").each(function(){$(this).get(0).onclick=null}),a.find(".hide-button a").click(function(){var a=$(this).get(0);change_state(a,"hide",
function(){r.spotlight.next()})}),a.find(".del-button a.yes").click(function(){var a=$(this).get(0);change_state(a,"del",function(){r.spotlight.next()})}),a.find(".report-button a.yes").click(function(){var a=$(this).get(0);change_state(a,"report",function(){r.spotlight.next()})}))},last_click=function(){var a=r.analytics.breadcrumbs.lastClickFullname();a&&$("body").hasClass("listing-page")&&($(".last-clicked").removeClass("last-clicked"),$(".id-"+a).last().addClass("last-clicked"))},login=function(){return post_user(this,
"login")},register=function(){return post_user(this,"register")},fetch_title=function(){var a=$("#url-field"),b=a.find(".NO_URL"),a=a.find(".title-status"),e=$("#url").val();if(e){if(!$('form#newlink textarea[name="title"]').val()||confirm("This will replace your existing title, proceed?"))a.show().text(reddit.status_msg.loading),b.hide(),$.request("fetch_title",{url:e})}else a.hide(),b.show().text("a url is required")},sr_cache=function(){if(!$.defined(reddit.sr_cache))reddit.sr_cache=[];return reddit.sr_cache},
highlight_reddit=function(a){$("#sr-drop-down").children(".sr-selected").removeClass("sr-selected");a&&$(a).addClass("sr-selected")},update_dropdown=function(a){var b=$("#sr-drop-down");if(a.length){var e=b.children(":first");e.removeClass("sr-selected");b.children().remove();$.each(a,function(c){if(!(c>10)){var c=a[c],j=e.clone();j.text(c);b.append(j)}});var c=$("#sr-autocomplete").outerHeight();b.css("top",c);b.show()}else b.hide()},sr_search=function(a){var a=a.toLowerCase(),b=sr_cache();b[a]?
update_dropdown(b[a]):$.request("search_reddit_names.json",{query:a,include_over_18:r.config.over_18},function(e){b[a]=e.names;update_dropdown(e.names)})},sr_name_up=function(a){var b=$("#sr-autocomplete").val(),e=window.old_sr_name||"";window.old_sr_name=b;if(b=="")hide_sr_name_list();else if(!(a.keyCode==38||a.keyCode==40||a.keyCode==9))if(a.keyCode==27&&reddit.orig_sr)$("#sr-autocomplete").val(reddit.orig_sr),hide_sr_name_list();else if(b!=e)reddit.orig_sr=b,sr_search($("#sr-autocomplete").val())},
sr_name_down=function(a){var b=$("#sr-autocomplete");if(a.keyCode==38||a.keyCode==40){var a=a.keyCode==38&&"up"||"down",e=$("#sr-drop-down .sr-selected:first"),c=$("#sr-drop-down .sr-name-row:first"),i=$("#sr-drop-down .sr-name-row:last"),j=null,j=a=="down"?e.length?e.get(0)==i.get(0)?null:e.next(":first"):c:e.length?e.get(0)==c.get(0)?null:e.prev(":first"):i;highlight_reddit(j);j?b.val($.trim(j.text())):b.val(reddit.orig_sr);return!1}else if(a.keyCode==13)return $("#sr-autocomplete").trigger("sr-changed"),
hide_sr_name_list(),b.parents("form").submit(),!1},hide_sr_name_list=function(){$("#sr-drop-down").hide()},sr_dropdown_mdown=function(a){reddit.sr_mouse_row=a;return!1},sr_dropdown_mup=function(a){reddit.sr_mouse_row==a&&(a=$(a).text(),$("#sr-autocomplete").val(a),$("#sr-drop-down").hide(),$("#sr-autocomplete").trigger("sr-changed"))},set_sr_name=function(a){a=$(a).text();$("#sr-autocomplete").trigger("focus").val(a);$("#sr-autocomplete").trigger("sr-changed")},select_form_tab=function(a,b,e){a=$(a).parent();
a.addClass("selected").siblings().removeClass("selected");a=a.parent("ul").next(".formtabs-content");a.find(b).show().find(":input").removeAttr("disabled").end();a.find(e).hide().find(":input").attr("disabled",!0)},expando_cache=function(){if(!$.defined(reddit.thing_child_cache))reddit.thing_child_cache=[];return reddit.thing_child_cache},expando_child=function(a){var b=expando_cache(),e=$(a).thing();e.find(".expando-button").addClass("expanded").removeClass("collapsed").get(0).onclick=function(){unexpando_child(a)};
var c=e.find(".expando"),i=e.thing_id()+"_cache";b[i]?(c.html($.unsafe(b[i])),$(document).trigger("expando_thing",e)):$.request("expando",{link_id:e.thing_id()},function(a){b[i]=a;c.html($.unsafe(a));$(document).trigger("expando_thing",e)},!1,"html");c.show();return!1},unexpando_child=function(a){var b=$(a).thing();b.find(".expando-button").addClass("collapsed").removeClass("expanded").get(0).onclick=function(){expando_child(a)};b.find(".expando").hide().empty()},show_edit_usertext=function(a){var b=
a.find(".usertext-edit"),e=a.find(".usertext-body"),c=b.find("div > textarea"),i=Math.max(e.children(".md").width(),500),j=Math.max(e.children(".md").height(),100);e.hide();b.show();c.css("width","");c.css("height","");c.get(0).scrollHeight>c.height()&&(e=Math.max(i-5,c.width()),c.width(e),b.width(e),b=Math.max(j,c.height()),c.height(b));a.find(".cancel, .save").show().end().find(".help-toggle").show().end();c.focus()},hide_edit_usertext=function(a){a.find(".usertext-edit").hide().end().find(".usertext-body").show().end().find(".cancel, .save").hide().end().find(".help-toggle").hide().end().find(".markhelp").hide().end()},
comment_reply_for_elem=function(a){var a=$(a),b=a.thing(),e=a.thing_id(),c=b.find(".child .usertext:first");if(!c.length||c.parent().thing_id()!=b.thing_id())c=$(".usertext.cloneable:first").clone(!0),a.new_thing_child(c),c.prop("thing_id").value=e,c.attr("id","commentreply_"+e),c.find(".error").hide();return c},edit_usertext=function(a){a=$(a).thing();a.find(".edit-usertext:first").parent("li").addBack().hide();show_edit_usertext(a.find(".usertext:first"))},cancel_usertext=function(a){a=$(a);a.thing().find(".edit-usertext:first").parent("li").addBack().show();
hide_edit_usertext(a.closest(".usertext"))},save_usertext=function(a){$(a).thing().find(".edit-usertext:first").parent("li").addBack().show()},reply=function(a){var b=comment_reply_for_elem(a),e=b.find("textarea");if(window.getSelection&&e.val().length==0){var c=window.getSelection(),i=$(c.focusNode).parents(".md").first(),j=$(c.anchorNode).parents(".md").first();i.length&&i.is(j)&&(c=c.toString(),c.length>0&&(c=c.replace(/^/gm,"> "),e.val(c+"\n\n"),e.scrollTop(e.scrollHeight)))}show_edit_usertext(b);
b.show();b.find(".cancel").get(0).onclick=function(){b.hide()};$(a).thing().find(".showreplies:visible").click();return!1},toggle_distinguish_span=function(a){a=$(a).parents("form")[0];$(a).children().toggle()},set_distinguish=function(a,b){change_state(a,"distinguish/"+b);$(a).children().toggle()},populate_click_gadget=function(){if($(".click-gadget").length){var a=clicked_items();a&&a.length&&(a=$.uniq(a,5),a.sort(),$.request("gadget/click/"+a.join(","),void 0,void 0,void 0,"json",!0))}},toolbar_p=
function(){this.toggle_linktitle=function(a){$(".title, .submit, .url, .linkicon").toggle();$(a).is(".pushed-button")?$(a).parents(".middle-side").removeClass("clickable"):($(a).parents(".middle-side").addClass("clickable"),$(".url").children("form").children("input").focus().select());return this.toggle_pushed(a)};this.toggle_pushed=function(a){a=$(a);a.is(".pushed-button")?a.removeClass("pushed-button").addClass("popped-button"):a.removeClass("popped-button").addClass("pushed-button");return!1};
this.push_button=function(a){$(a).removeClass("popped-button").addClass("pushed-button")};this.pop_button=function(a){$(a).removeClass("pushed-button").addClass("popped-button")};this.serendipity=function(){this.push_button(".serendipity");return!0};this.show_panel=function(){$("body",parent.inner_toolbar.document).addClass("expanded")};this.hide_panel=function(){$("body",parent.inner_toolbar.document).removeClass("expanded")};this.resize_toolbar=function(){var a=$("body").height();parent.document.body.rows=
a+"px, 100%"};this.login_msg=function(){$(".toolbar-status-bar").show();$(".login-arrow").show();this.resize_toolbar();return!1};this.top_window=function(){for(var a=window;a!=a.parent;)a=a.parent;return a.parent};var a=null;this.panel_loadurl=function(b){try{return window.parent.inner_toolbar.reddit_panel.location==b?!1:(a!=null&&(this.pop_button(a),a=null),!0)}catch(c){return!0}};var b=0;this.comments_pushed=function(a){(b=!b)?(this.push_button(a),this.show_panel()):(this.pop_button(a),this.hide_panel())};
this.gourl=function(a,b){var i=$(a).find('input[type="text"]').val(),i=b+escape(i);this.top_window().location.href=i;return!1};this.pref_commentspanel_hide=function(){$.request("tb_commentspanel_hide")};this.pref_commentspanel_show=function(){$.request("tb_commentspanel_show")}},clear_all_langs=function(a){$(a).parents("td").find('input[type="checkbox"]').prop("checked",!1)},check_some_langs=function(a){$(a).parents("td").find("#some-langs").prop("checked",!0)},fetch_parent=function(a,b,e){$(a).css("color",
"red").html(reddit.status_msg.loading);var c=$(a).thing();if(c.find(".uncollapsed .parent").length==0){var i="";$.getJSON(b,function(b){$.each(b,function(){this&&this.data.children&&$.each(this.data.children,function(){if(this.data.name==e)i=this.data.body_html})});i&&c.find(".noncollapsed .md").first().before('<div class="parent rounded">'+$.unsafe(i)+"</div>");$(a).parent("li").addBack().remove()})}return!1},big_mod_action=function(a,b){if(!a.hasClass("pressed"))a.addClass("pressed"),d={id:a.thing_id()},
a.siblings(".status-msg").hide(),b==-1?(d.spam=!1,$.request("remove",d,null,!0),a.siblings(".removed").show()):b==-2?($.request("remove",d,null,!0),a.siblings(".spammed").show()):b==1&&($.request("approve",d,null,!0),a.siblings(".approved").show());a.siblings(".pretty-button").removeClass("pressed");return!1},big_mod_toggle=function(a,b,e){a.toggleClass("pressed");$.request(a.is(".pressed")?b:e,{id:a.thing_id()},null,!0);return!1};$(function(){function a(){return toggle(this)}$("body").click(close_menus);
$("body").set_thing_init(updateEventHandlers);"placeholder"in document.createElement("input")||$("textarea[placeholder], input[placeholder]").addClass("gray").each(function(){var a=$(this),e=a.attr("placeholder");a.val()==""&&a.val(e)});$("textarea.gray, input.gray").focus(function(){$(this).attr("rows",7).filter(".gray").removeClass("gray").val("")});reddit.logged&&$.cookie_name_prefix(reddit.logged);$.default_cookie_domain(reddit.cur_domain.split(":")[0]);last_click();$(window).on("pageshow",function(){last_click()});
$('#search input[name="q"]').focus(function(){$("#searchexpando").slideDown()});$("#search_showmore").click(function(a){$("#search_showmore").parent().hide();$("#moresearchinfo").slideDown();a.preventDefault()});$("#moresearchinfo").prepend('<a href="#" id="search_hidemore">[-]</a>');$("#search_hidemore").click(function(a){$("#search_showmore").parent().show();$("#moresearchinfo").slideUp();a.preventDefault()});$("#shortlink-text").click(function(){$(this).select()});$("body").delegate(".ajax-yn-button",
"submit",function(){var a=$(this).find('input[name="_op"]').val();post_form(this,a);return!1}).delegate(".ajax-yn-button .togglebutton","click",a).delegate(".ajax-yn-button .no","click",a).delegate(".ajax-yn-button .yes","click",function(){$(this).closest("form").submit()})});var show_friend=function(a){$("div.content .author.id-"+a).addClass("friend").next(".userattrs").each(function(){$(this).html()?$(this).find(".friend").length==0&&$(this).find("a:first").debug().before('<a class="friend" title="friend" href="/prefs/friends">F</a>,'):
$(this).html(' [<a class="friend" title="friend" href="/prefs/friends">F</a>]')})},show_unfriend=function(a){$(".author.id-"+a).removeClass("friend").next(".userattrs").each(function(){$(this).find("a.friend").remove();$(this).find("a").length==0&&$(this).html("")})},search_feedback=function(a,b){f=$("form#search");var e=f.find('input[name="q"]').val(),c=f.find('input[name="sort"]').val(),i=f.find('input[name="t"]').val();$.request("searchfeedback",{q:e,sort:c,t:i,approval:b},null,!0);a.siblings(".pretty-button").removeClass("pressed");
a.siblings(".thanks").show();a.addClass("pressed");return!1},highlight_new_comments=function(a){var b;for(b=0;b<=9;b++)items=$(".comment-period-"+b),a>=0&&b>=a?items.addClass("new-comment"):items.removeClass("new-comment")},save_href=function(a){a.attr("srcurl")||a.attr("srcurl",a.attr("href"));return a},pure_domain=function(a){(a=a.match(/:\/\/([^/]+)/))&&(a=a[1].replace(/^www\./,""));return a},parse_domain=function(a){var b=pure_domain(a);b||(a=a.match(/\/r\/([^/]+)/))&&(b="self."+a[1].toLowerCase());
return b};r.spotlight={};r.spotlight.init=function(){var a=$(".organic-listing");if(a.length){$(".organic-listing .arrow.prev").on("click",$.proxy(this,"prev"));$(".organic-listing .arrow.next").on("click",$.proxy(this,"next"));var b,e=r.analytics.breadcrumbs.lastClickFullname(),c=$(e?".id-"+e:null);c.length&&a.has(c).length?(r.debug("restoring spotlight selection to last click"),b={fullname:e}):b=this.chooseRandom();this.lineup=_.chain(this.lineup).reject(function(a){return _.isEqual(b,a)}).shuffle().unshift(b).value();
this.lineup.pos=0;r.spotlight._advance(0)}};r.spotlight.setup=function(a,b,e,c){this.organics=[];this.lineup=[];_.each(a,function(a){this.organics.push(a);this.lineup.push({fullname:a})},this);b&&this.lineup.push(".interestbar");this.interest_prob=b;this.show_promo=e;this.srnames=c;this.init()};r.spotlight.requestPromo=function(){return $.ajax({type:"POST",url:"/api/request_promo",timeout:1E3,data:{srnames:this.srnames,r:r.config.post_site}}).pipe(function(a){return a?($item=$(a),$item.hide().appendTo($(".organic-listing")),
$item):!1})};r.spotlight.chooseRandom=function(){$(".organic-listing");return this.show_promo?this.requestPromo():Math.random()<this.interest_prob?".interestbar":{fullname:this.organics[Math.floor(Math.random()*this.organics.length)]}};r.spotlight._materialize=function(a){if(!a||a instanceof $||a.promise)return a;var b=$(".organic-listing"),e;e=_.isString(a)?a:a.campaign?'[data-cid="'+a.campaign+'"]':'[data-fullname="'+a.fullname+'"]';b=b.find(e);if(b.length)return b;else r.error("unable to locate spotlight item",
e,a)};r.spotlight._advancePos=function(a){return(this.lineup.pos+a+this.lineup.length)%this.lineup.length};r.spotlight._materializePos=function(a){return this.lineup[a]=this._materialize(this.lineup[a])};r.spotlight._advance=function(a){var b=$(".organic-listing"),e=b.find(".nextprev"),c=b.find(".thing:visible"),i=this._advancePos(a),j=this._materializePos(i),g=setTimeout(function(){e.toggleClass("working",j.state&&j.state()=="pending")},200);this.lineup.pos=i;var m=$.when(j);m.always(_.bind(function(j){clearTimeout(g);
this.lineup.pos==i&&(m.state()=="rejected"||!j?this.lineup.length>1?this._advance(a||1):b.hide():(e.removeClass("working"),b.removeClass("loading"),b.css("background-color",j.css("background-color")),c.hide(),j.show(),this.help(j),this.lineup.pos!=0&&(this._materializePos(this._advancePos(1)),this._materializePos(this._advancePos(-1)))))},this))};r.spotlight.next=$.proxy(r.spotlight,"_advance",1);r.spotlight.prev=$.proxy(r.spotlight,"_advance",-1);r.spotlight.help=function(a){var b=$("#spotlight-help");
b.length&&$(function(){b.data("HelpBubble").hide(function(){b.find(".help-section").hide();a.hasClass("promoted")?b.find(".help-promoted").show():a.hasClass("interestbar")?b.find(".help-interestbar").show():b.find(".help-organic").show()})})}}catch(err$$6){r.sendError("Error running module","reddit-init.js",":",err$$6)};
r.i18n.setPluralForms('(n != 1)');r.i18n.addMessages({"unsave": [null, "afvista"]});